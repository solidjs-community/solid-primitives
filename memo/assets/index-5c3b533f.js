import{h as p,o as d,c as h,u as m,k as M,l as b,m as j,a as S,n as v,p as w,r as O}from"./index-89db63fb.js";var T=(e,o)=>{let s;const r=()=>clearTimeout(s);return p()&&d(r),Object.assign((...t)=>{s!==void 0&&r(),s=setTimeout(()=>e(...t),o)},{clear:r})},C=(e,o)=>{let s=!1,r,c;const t=(...n)=>{c=n,!s&&(s=!0,r=setTimeout(()=>{e(...c),s=!1},o))},a=()=>{clearTimeout(r),s=!1};return p()&&d(a),Object.assign(t,{clear:a})},x=()=>{};function z(e){return e!==null&&(typeof e=="object"||typeof e=="function")}function g(e,...o){return typeof e=="function"?e(...o):e}var A=e=>p()?d(e):e,I=()=>{let e=[];const o=()=>e=[];return{push:(...s)=>e.push(...s),execute(s,r,c,t){e.forEach(a=>a(s,r,c,t)),o()},clear:o}};function R(e){const o={...e},s={...e},r=new Map,c=n=>{const i=r.get(n);if(i)return i[0]();const u=h(o[n],{internal:!0});return r.set(n,u),delete o[n],u[0]()},t=(n,i)=>{const u=r.get(n);if(u)return u[1](i);n in o&&(o[n]=g(i,[o[n]]))};for(const n in e)Object.defineProperty(s,n,{get:c.bind(void 0,n)});return[s,(n,i)=>{if(z(n)){const u=m(()=>Object.entries(g(n,s)));M(()=>{for(const[l,f]of u)t(l,()=>f)})}else t(n,i);return s}]}const W=(e,o)=>e.length>0?()=>e(m(o)):e;function y(e,o){const s=p(),r=new Set;let c=0,t=!1;return d(()=>{for(const a of r)a();r.clear(),t=!0}),a=>{if(t){m(a);return}c++,S(n=>{r.add(n);let i=!0;v(()=>{if(i)return i=!1,a();--c===0&&m(e),n(),r.delete(n)},o)},s)}}function L(e,o){const[s,r]=h(0),c=e.map((t,a)=>b(()=>(r(a),t())));return b(()=>c.map(t=>t())[s()],void 0,o)}function V(e,o,s){let r=()=>o;const[c,t]=h(o),a=b(W(e,()=>r()),o);return[r=L([c,a],s),n=>t(()=>typeof n=="function"?n(m(r)):n)]}function D(e,o,s,r,c){let t=!0;const[a,n]=h((()=>{let u;return v(w(e,(l,f)=>{t?(u=o(l,f,r),t=!1):i(l,f)})),u})(),c),i=T((u,l)=>{n(()=>o(u,l,a()))},s);return a}function E(e,o,s,r){let c=x;const t=y(()=>c()),[a,n]=h((()=>{let i;return t(()=>i=e(s)),i})(),r);return c=C(()=>t(()=>n(e)),o),a}function q(e,o={}){const[s,r]=h(o.value,o),c=[];return v(async()=>{const t=e(m(s));t instanceof Promise?(c.push(t),t.then(a=>c.includes(t)&&r(()=>a)),t.finally(()=>{const a=c.indexOf(t);c.splice(0,a+1)})):r(()=>t)},void 0),s}function P(e,o,s){const r=p()??void 0;let c=0,t=o,a=!0,n,i,u=!1;d(()=>{i&&i(),u=!0});const l=y(()=>a=!n);return()=>u||!j()?n?n():(a&&(l(()=>t=e(t)),a=!1),t):(c++,d(()=>c--),n||S(f=>{i=f,n=b(()=>c?t=e(t):(i(),i=n=void 0,t),t,s)},r),n())}function B(...e){const o=new Map,s=p(),r=typeof e[1]=="function"?e[0]:void 0,c=typeof e[1]=="function"?e[1]:e[0],t=typeof e[1]=="object"?e[1]:typeof e[2]=="object"?e[2]:{},a=n=>{if(o.has(n))return o.get(n)();const i=O(s,()=>P(u=>c(n,u),void 0,t));return(t.size===void 0||o.size<t.size)&&o.set(n,i),i()};return r?()=>a(r()):a}export{q as a,I as b,P as c,R as d,D as e,E as f,B as g,V as h,A as t};
